inherit:
  - copy

depends:
  - tools::buildsys

checkoutVars: [CVSROOT]
checkoutSCM:
  - scm: cvs
    cvsroot: ${CVSROOT}
    module: pdk

multiPackage:
  # Regular binary for target architecture
  bin:
    inherit: [make]
    buildScript: |
      perl "$2"/Make.pl IN="$1" OUT="." CC="${CC}" CFLAGS="${CFLAGS}" LDFLAGS="${LDFLAGS}" TARGET="${TARGET:-POSIX}" RUN="${RUN:-}"
      doMake
      doMake install-bin

    packageScript: |
      shallowCopy "$1"/result .

  # Documentation
  doc:
    inherit: [make]
    buildScript: |
      perl "$2"/Make.pl IN="$1"
      doMake install-doc

    packageScript: |
      shallowCopy "$1"/result/doc .
