inherit:
  - copy

checkoutVars: [CVSROOT]
checkoutSCM:
  - scm: cvs
    cvsroot: ${CVSROOT}
    module: pdk

multiPackage:
  bin:
    # FIXME: port to buildsys
    inherit: [make]
    buildScript: |
      deepCopy "$1" .
      doMakeDefault all

    packageScript: |
      mkdir -p bin include lib
      for i in phostpdk.h version.h;                          do cp "$1/$i" include/; done
      for i in libpdk.a;                                      do cp "$1/$i" lib/;     done
      for i in sendmess crack ptscore killrace pmaster pally; do cp "$1/$i" bin/;     done

      # Some makefiles expect include/lib in one directory
      mkdir -p legacy
      cp include/* lib/* legacy

#   # PDK i386 (sandbox build for consumption by other sandbox builds)
#   i386:
#     root: true
#     depends:
#       - toolchain-i386
#       - name: uchroot
#         use: [tools]
#     buildTools: [uchroot]
#
#     buildScript: |
#       deepCopy "$1" .
#       uchroot -R/="${BOB_DEP_PATHS[toolchain-i386]}" -W/dev=/dev -W/tmp=/tmp -W/home=. -DLC_ALL=C -C/home make -j4 all CC=gcc-3.3
#
#     packageScript: |
#       for i in phostpdk.h version.h libpdk.a sendmess crack ptscore killrace pmaster pally; do
#         cp "$1/$i" .
#       done

  doc:
    buildScript: |
      deepCopy "$1" .
      make docs

    packageScript: |
      for i in pdk.inf pdk-api.txt; do
      cp "$1/$i" .
      done
