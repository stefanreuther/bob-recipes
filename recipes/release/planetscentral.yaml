root: true

multiPackage:
  bin:
    inherit:
      - env::amd64-linux-gcc49
      - copy
    depends:
      - server::lighttpd-ssl-bin
      - server::redis-bin
      - libs::openssl-bin
      - planets::c2ng-bin
    buildScript: |
      for i in server::lighttpd-ssl-bin server::redis-bin libs::openssl-bin planets::c2ng-bin; do
        shallowCopy "${BOB_DEP_PATHS[$i]}" .
      done
    packageScript: |
      shallowCopy "$1" .


# As of 20190310, this does not work; bob seems to pass the sandbox path to this recipe which runs outside the sandbox.
#   # Test it: test the programs built using the sandbox vs.
#   # FIXME: this duplicates the c2systest recipe - can we do better?
#   # FIXME: use a website release
#   # FIXME: where to get planetscentral-programs from?
#   test:
#     inherit:
#       - env::native-gcc
#     depends:
#       - release::planetscentral-bin
#       - planets::website-daily-dat
#       - libs::afl-host
#
#     checkoutSCM:
#       - scm: cvs
#         cvsroot: ${CVSROOT}
#         module: c2systest
#         dir: c2systest
#       - scm: cvs
#         cvsroot: ${CVSROOT}
#         module: planetscentral-programs
#         dir: pcc-programs
#
#     buildScript: |
#       cd "$1/c2systest"
#       perl test.pl -Dc2ng="${BOB_DEP_PATHS[release::planetscentral-bin]}/opt/c2ng/bin" \
#                    -Dafl="${BOB_DEP_PATHS[release::planetscentral-bin]}/opt/afl/bin" \
#                    -Dc2web="${BOB_DEP_PATHS[planets::website-daily-dat]}" \
#                    -Dprograms=../pcc-programs
#
#     packageScript: |
#       true
